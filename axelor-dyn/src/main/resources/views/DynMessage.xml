<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://apps.axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://apps.axelor.com/xml/ns/object-views http://apps.axelor.com/xml/ns/object-views/object-views_2.0.xsd">

  <selection name="dyn.reference.select">
    <option value="com.axelor.contact.db.Contact" data-domain="self.email LIKE '%gmail%'">Contact</option>
    <option value="com.axelor.sale.db.Order">SaleOrder</option>
  </selection>

  <grid name="dyn-message-grid" title="Messages" model="com.axelor.dyn.db.DynMessage">
    <field name="subject" />
    <field name="date" />
  </grid>

  <form name="dyn-message-form" title="Message" model="com.axelor.dyn.db.DynMessage" cols="2">
    <field name="subject" />
    <field name="recipients" widget="TagSelect" />
    <field name="referenceModel" widget="RefSelect[related=referenceId]" title="Reference"/>
    <notebook colSpan="2">
      <page title="Body" cols="1">
        <field name="body" widget="html" />
      </page>
      <page title="Replies" cols="1">
        <field name="replies">
          <form cols="2" title="Reply">
            <field name="subject" />
            <field name="body" showTitle="false" colSpan="2" widget="html[lite=true]" />
          </form>
        </field>
      </page>
    </notebook>
  </form>

  <form name="dyn-message-form2" title="Message" model="com.axelor.dyn.db.DynMessage" cols="1">
    <group readonly="true" cols="3" colWidths="42,*,60">
      <field name="dummy1" showTitle="false" widget="Image[width=48|height=48]" css="trail-avatar"/>
      <group cols="1">
        <field name="subject" showIf="!parent"/>
        <field name="body" widget="html"/>
      </group>
      <group cols="3" colWidths="20,20,20">
        <button name="btnStar" icon="icon-star-empty" iconHover="icon-star" link=""/>
        <button name="btnReply" icon="icon-reply" link=""
          onClick="com.axelor.dyn.web.DynController:showReply"/>
        <button name="btnDone" icon="icon-ok" link=""/>
      </group>
    </group>
    <group readonly="true" css="trail-form-footer" cols="2" colWidths="*,20">
      <group cols="5" css="pull-left">
        <field name="author" showTitle="false"/>
        <label title="to"/>
        <field name="recipients" showTitle="false" widget="TagSelect[max=3]"/>
        <label title=" &amp;nbsp;â€¢"></label>
        <field name="createdOn" widget="RelativeTime" showTitle="false"/>
      </group>
      <button name="btnExpand" icon="icon-double-angle-down" link=""
        onClick="com.axelor.dyn.web.DynController:showReplies" showIf="__expandable"/>
    </group>
    <group cols="3" colWidths="100,100,*" showIf="canReply">
      <field name="reply" showTitle="false" colSpan="3" widget="Text" required="true"/>
      <button name="btnSend" title="Send" readonlyIf="$invalid()"
        onClick="com.axelor.dyn.web.DynController:sendReply"/>
      <button name="btnCancel" title="Cancel"
        onClick="com.axelor.dyn.web.DynController:showReply"/>
      <spacer colSpan="2"/>
    </group>
  </form>

  <form name="dyn-message-form3" title="Message" model="com.axelor.dyn.db.DynMessage" cols="1">
    <field name="subject" required="true"/>
    <field name="recipients" required="true" widget="TagSelect" />
    <field name="reply" widget="Text" required="true" />
    <group cols="2" colWidths="100,*">
      <button name="btnSend" title="Send" readonlyIf="$invalid()"
        onClick="com.axelor.dyn.web.DynController:sendReply"></button>
      <spacer/>
    </group>
  </form>

</object-views>
